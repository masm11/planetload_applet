# $Id: README 39 2005-07-19 13:10:20Z masm $
PlanetloadApplet -- Planet と協調動作するネットワークトラフィックモニタ

* これは

ネットワークのトラフィックをグラフに表示する、GNOME panel の applet で
す。Planet をインストールしてあれば、Planet を呼び出すこともでき
ます。


* 必要なもの

  GNOME 2.2.0 以上
    glib-2.2
    gtk+-2.2
    libpanelapplet-2.0
    libgnomeui-2.0
    libgtop-2.0

  Planet 4.0.0 以上  (なくても良い)


* インストール方法

  ./configure
  make
  make install


* 使い方

  panel のメニューから、
    パネルに追加/インターネット/Planetload Applet
  を実行すると起動します。

  この applet で右クリックするとメニューが表示されます。Planet のスキー
  ム名も並んでいます。スキーム名を選択すると、Planet が呼び出され、ス
  キームが切替わります。

  netscheme の場所が /sbin でない場合、正常に動作しませんので、以下の
  設定の項を参照して設定してください。

  グラフの縦軸は対数です。横線1本目が 1Kbps、2本目が 1Mbps となります。


* 設定

  メニューから設定を選択すると、設定ダイアログが表示されます。

  - インタフェース

    どのインタフェースを表示するかを設定します。ほとんどは表示の設定の
    みで、実際のインタフェースには影響しません。

    背景色やテキスト色は、インタフェースの状態によって変化します。
    「CONNECT」は、
        * インタフェースが UP で、IPアドレスがまだない場合
        * PPP で、インタフェースが DOWN で、PPP ロックファイルがある場合。
    のいずれかの場合に使用されます。

    前景色は描画方式により異なります。「描画方式」の項を参照してくだ
    さい。

    Click Command は、ここでコマンドを指定しておくと、グラフを左クリッ
    クした時にそのコマンドを実行できます。UP 時と DOWN 時で別のコマンド
    を指定できます。CONNECT 中にクリックした場合は UP時のコマンドが実行
    されます。
    例えば、以下のように指定しておくと便利かもしれません。

	/sbin/ifctl eth0 toggle

    このコマンドの意味は Planet のドキュメントを参照してください。

  - オプション

    フォント:	グラフ内に表示されるインタフェース名と、グラフの下に表
		示されるスキーム名のフォントを指定します。

    更新間隔:	グラフの更新間隔を指定します。ミリ秒単位ですが、それほ
		ど正確ではありません。

    描画方式:	描画の方法を選択します。詳しくは後に記述しています。
		環境・性能に合わせて選択してください。

  - Planet

    Planet	このチェックを外すと、Planet を使用しなくなり、Planet
		関係の表示・機能が外れます。

    スキーム名のリストを得るコマンド:
		スキーム名のリストを得るためのコマンドを指定します。こ
		の設定は次の起動時に反映されます。Planet のチェックを
		入れ直しても反映されます。

    スキームを切替えるコマンド:
		スキームを変更するためのコマンドを指定します。必ず %s 
		を1回だけ指定してください。ここにスキーム名が入ります。

    スキーム名の表示:
		グラフの下にスキーム名を表示するかどうかを指定します。


* 描画方式

  - 綺麗

     以下の図のような階層になっています。

                                色                     描画条件
         --------------  名前。UP/DOWN による。
         --------------  横線。                       UPの場合のみ。
         --------------  前景。送受信の割合いによる。 UPの場合のみ。
         --------------  背景。UP/DOWN による。
        ---------------- Window

     Window に背景、前景、横線、名前の順で Window に描画していきます。

     前景色は IN 色と OUT 色を HSV 空間で合成しています。

     半透明を処理するため、Window に表示されているものを読み取り、書き
     換えて Window に描画する、という処理を 4回行います。半透明が綺麗
     に処理できますが、計算や通信の負荷は高くなります。

  - 軽量

     以下の図のような階層になっています。

                                色                          描画条件
       ┌
       │--------------  名前。UP/DOWN による。            色のあるピクセルのみ。
       │--------------  横線。                            UPの場合のみ。
       │--------------  前景。送受信の割合いにより3段階。 UPの場合のみ。
       │--------------  背景。UP/DOWN による。
       └
        ---------------- Window

     不透明度は完全透明/完全不透明の2段階のみです。名前は不透明度に対
     応しておらず、常に完全不透明です。名前は UP/DOWN の状態に応じて、
     名前全体の色が決まります。

     前景は、IN と OUT の比率により、
        IN * 2 >= OUT  →  IN 色
        OUT * 2 >= IN  →  OUT 色
       そちらでもない  →  中間
     となります。

     まず、背景から名前までを合成します。その結果、各ピクセルにおいて
     最上位層の色が選択されます。そして、それを Window に描画します。
     この時、各ピクセルが完全透明なら描画されず、Window が見えます。

     例えば、横線の不透明度を 0 にしてあると、前景と背景がどんな色であ
     ろうと、横線の位置(かつ、名前でない場所)は Window が見えることに
     なります。

     いい加減ですが、計算や通信の負荷は軽くなっています。

  - 分離

     IN と OUT を別々にグラフにします。OUT は中央より上向きに、IN は
     下向きに描画します。描画方法自体は綺麗と同じです。


* 著作権など

    このソフトウェアおよびその付属物の著作権は原野裕樹が保持します。
    ライセンスは GPL2 とします。GPL2 に従う限り、自由にしてください。


* 作者

    原野裕樹 <masm@flowernet.gr.jp>



; EOF
